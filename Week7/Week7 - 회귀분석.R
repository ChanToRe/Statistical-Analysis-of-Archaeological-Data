library(ggplot2)
library(car)

#Data
df <- read.csv("~/Desktop/????????????????????? ???????????? ?????????????????????????????????(???????????????)/Week7 - ??????????????????????????????/Data/KIm_2009_Data.csv")
head(df)
LR_df <- read.csv("~/Desktop/????????????????????? ???????????? ?????????????????????????????????(???????????????)/Week7 - ??????????????????????????????/Data/SiteArea.csv", stringsAsFactors = T)
head(LR_df)

#실용량, 구경 단순선형 회귀분석
reg1 <- lm(실용량 ~ 구경, df)
summary(reg1)

ggplot(df, aes(x = 구경, y = 실용량)) +
  geom_point() +
  stat_smooth(method = 'lm')

#실용량, 기고 단순선형 회귀분석
reg2 <- lm(실용량 ~ 기고, df)
summary(reg2)

ggplot(df, aes(x = 기고, y = 실용량)) +
  geom_point() +
  stat_smooth(method = 'lm')

#다중선형 회귀분석
reg3 <- lm(실용량 ~ 구경+기고+목지름+견부각, df)
summary(reg3)

cor(df$기고, df$목지름)
cor(df$기고, df$견부각)
vif(reg3)

#로지스틱 회귀분석
reg4 <- glm(LR_df$Site ~ LR_df$Area, data = LR_df, family = binomial())
summary(reg4)
anova(reg4, test="Chisq")
            
ggplot(LR_df, aes(x = Area, y = Site)) +
  geom_point() +
  geom_line(aes(x=Area, y=1+(1/(1+(1/exp(37.9839-1.0308*Area))))), color = "red")
